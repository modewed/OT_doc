<HTML>
<HEAD>
<TITLE>SaveWorkData()</TITLE>
<link rel="stylesheet" href="../ot_common_ui.css" type="text/css">
<link rel="stylesheet" href="../ot_sdk.css" type="text/css">
<script language="JavaScript" src="../documentation.js"></script>
</HEAD>

<BODY CLASS="Body" TEXT="#000000" BGCOLOR="#FFFFFF" link="#003366" alink="#3300FF" vlink="#660033" background="../images/pattern.gif">
<script language="JavaScript">updateParentHeader( 'Code' );</script>
<script language="JavaScript">includeContentContainer( 'wfbuilder', true );</script>

<p class="body">
<p class="title">SaveWorkData()</p>
<p class="body">This code sample describes how to update the 
information stored in the database tables for the Table Values data 
type. This script calls the <a href="updatetablevalues.html">UpdateTableValues()</a>
script which then calls the <a href="deleteworkdata.html">DeleteWorkData()</a> 
script (to remove the previous information) and the 
<a href="savetablevalues.html">SaveTableValues()</a> script (to add the 
new information).</p>

<pre class="code">
		Function Boolean SaveWorkData( \
			Object 		prgCtx, \
			WAPIWORK 	work, \
			Record 		taskRec, \
			Dynamic 	data )
			
			Boolean 	success
			Record 		r
			Object 		session = prgCtx.WSession()
			
			success = session.StartTrans()

			//Call the UpdateTableValues() script.

		if ( success )
			success = .UpdateTableValues( prgCtx, data )
		if ( !session.EndTrans( success ) )
			success = False
		end
	end
	
	return( success )
end</pre>

<script language="JavaScript">IncludeFooter();</script>

</BODY>
</html>
