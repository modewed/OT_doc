<HTML>
<HEAD>
<TITLE>ListTemplates()</TITLE>

<link rel="stylesheet" href="../ot_common_ui.css" type="text/css">
<link rel="stylesheet" href="../ot_sdk.css" type="text/css">
<script language="JavaScript" src="../documentation.js"></script>
</HEAD>

<BODY CLASS="Body" TEXT="#000000" BGCOLOR="#FFFFFF" link="#003366" alink="#3300FF" vlink="#660033" background="../images/pattern.gif">
<script language="JavaScript">updateParentHeader( 'Code' );</script>
<script language="JavaScript">includeContentContainer( 'wfbuilder', true );</script>
<p>


<p class="title">ListTemplates()</p><p class="body">
This code sample describes how to create a script that returns a list of HTML
templates that are stored in the templates directory of the custmod module (for example,
c:/opentext/module/custmod_1_0_0/templates).
<pre class="code">
	Function List ListTemplates()
		String templatePath
		String moduleDir = $Custmod.custtaskmodule.PathPrefix()
		String templatesDir = moduleDir + &quot;templates&quot; + File.Separator()

		List vFileListList = File.FileList( templatesDir )
		List retList = {}
		
		//Retrieve the list of HTML templates that are stored in your
		//module's /template directory. These are the HTML templates that
		//the creators of workflow maps can attach to the custom display
		//step type in the Workflow Designer.

		if ( !IsError( vFileListList ) && \
		( Length( vFileListList ) > 0 ) )
			for templatePath in vFileListList
				retList = { @retList, File.GetName( templatePath ) }
			end
		end
		return( retList )
	end</pre>


<script language="JavaScript">IncludeFooter();</script>
</body>
</html>
