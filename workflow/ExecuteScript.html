<HTML>
<HEAD>
<TITLE>ExecuteScript()</TITLE>

<link rel="stylesheet" href="../ot_common_ui.css" type="text/css">
<link rel="stylesheet" href="../ot_sdk.css" type="text/css">
<script language="JavaScript" src="../documentation.js"></script>
</HEAD>

<BODY CLASS="Body" TEXT="#000000" BGCOLOR="#FFFFFF" link="#003366" alink="#3300FF" vlink="#660033" background="../images/pattern.gif">
<script language="JavaScript">updateParentHeader( 'Code' );</script>
<script language="JavaScript">includeContentContainer( 'wfbuilder', true );</script>
<p>


<p class="title">ExecuteScript()</p><p class="body">
This code sample describes how to create a script that locates and runs the
callback script that is associated with this custom display step.
<pre class="code">
	Function Boolean ExecuteScript( \
		Object prgCtx, \
		WAPIWORK work, \
		Dynamic taskInfo, \
		String scriptName )

		Boolean success = True
		Dynamic err = Undefined

		String moduleDir = $Custmod.custtaskmodule.PathPrefix()
		String scriptsDir = moduleDir + &quot;scripts&quot; + File.Separator()
		String scriptFile = scriptsDir + scriptName

		//Convert the HTML files that have OScript in them to pure HTML.

		Dynamic result = $WebLingo.WebScript.RunFileWithArglist( \
									scriptFile, \
									Undefined, \
									Undefined, \
									{ prgCtx, work, taskInfo }, \
									true )
		if ( Type( result ) == ListType )
			echo( &quot;Error during $WebLingo.WebScript.RunFile =&quot;, result )
			success = false
		elseif IsNotError( result )
			success = true
		else
			echo( &quot;Error during $WebLingo.WebScript.RunFile =&quot;, result )
			success = false
		end
		return( success )
	end</pre>


<script language="JavaScript">IncludeFooter();</script>
</body>
</html>
